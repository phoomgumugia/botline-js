//„Äå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó‡∏ä‡∏∑‡πà‡∏≠ SETTING „Äç
    let file = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('SETTING');  // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ "SETTING"
    let file_id = file.getRange('C5').getValue();                                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏µ‡∏ó‡πÑ‡∏≠‡∏î‡∏µ > ‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏•‡πå C5
    let token_line = file.getRange('C6').getValue();                             // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ó‡πÄ‡∏Ñ‡πà‡∏ô > ‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏•‡πå C6

    let CHANNEL_ACCESS_TOKEN = token_line;
    let line_endpoint = 'https://api.line.me/v2/bot/message/reply';

    let data_sheet = SpreadsheetApp.openById(file_id).getSheets()[0]             // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤
    let data_table = data_sheet.getRange(2, 1, data_sheet.getLastRow(), data_sheet.getLastColumn()).getValues(); // ‡∏ö‡∏≠‡∏Å‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Ç‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤
    let result = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤';  // ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤'#A1
// ‡∏à‡∏ö SETTING 


//„Äå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô doPost „Äç
  function doPost(e) {
    let json = JSON.parse(e.postData.contents);     // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤ JSON ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤ JavaScript)
    let message = json.events[0].message.text;      // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏°‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô
    let reply_token = json.events[0].replyToken;    // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏ó‡πÄ‡∏Ñ‡πà‡∏ô (Token ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô ID CARD ‡∏´‡∏£‡∏∑‡∏≠ PASSPORT)

    for (let i = 0; i < data_table.length; i++) 
    {
      if (data_table[i][0] == message) // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheet ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà i ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A 
                                       // (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A=0, B=1, C=2 ‡πÑ‡∏•‡πà‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÑ‡∏´‡∏ô) 
          {                      
            i = i + 2;
            let column_A = data_sheet.getRange(i, 1).getValue();   // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ 
            let column_B = data_sheet.getRange(i, 2).getValue();   // ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 
            let column_C = data_sheet.getRange(i, 3).getValue();   // ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• 
            let column_D = data_sheet.getRange(i, 4).getValue();   // ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà 
            let column_E = data_sheet.getRange(i, 5).getValue();   // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 
            let column_F = data_sheet.getRange(i, 6).getValue();   // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô            
            let column_G = data_sheet.getRange(i, 7).getValue();   // ‡∏≠‡∏≤‡∏¢‡∏∏‡∏á‡∏≤‡∏ô 
            let column_H = data_sheet.getRange(i, 8).getValue();   // ‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô 
            let column_I = data_sheet.getRange(i, 9).getValue();   // ‡∏•‡∏≤‡∏Å‡∏¥‡∏à 
            let column_J = data_sheet.getRange(i, 10).getValue();  // ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢ 
            let column_K = data_sheet.getRange(i, 11).getValue();  // ‡∏•‡∏¥‡πâ‡∏á‡∏Ñ‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û 
            let column_L = data_sheet.getRange(i, 12).getValue();  // ‡∏≠‡∏≤‡∏¢‡∏∏ 

            let date = new Date(column_F);                                       // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)
                date.setDate(date.getDate() + 1);                                // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)
            let formattedDate = Utilities.formatDate(date, "GMT", "dd/MM/yyyy"); // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)
                   
            result = 

                    /* ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± üåî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Flex-simulator (üö©START) üåî ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± */ 
                     {
                        "type": "bubble",
                        "size": "mega",//‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î flex ‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏õ‡πÄ‡∏•‡πá‡∏Å giga, mega(default), kilo, hecto, deca, micro, nano
                        "hero": {
                          "type": "box",
                          "layout": "vertical",
                          "contents": [
                            {
                              "type": "image",
                              "url": "https://img5.pic.in.th/file/secure-sv1/IMG_0137003.jpeg", // ‡∏•‡∏¥‡πâ‡∏á‡∏Ñ‡πå Image COVER 
                              "size": "full",
                              "aspectMode": "cover",
                              "aspectRatio": "10:8"
                            },
                            {
                              "type": "box",
                              "layout": "vertical",
                              "contents": [
                                {
                                  "type": "image",
                                  "url": column_K,
                                  "size": "5xl", //‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡πá‡∏Å‡πÑ‡∏õ‡πÉ‡∏´‡∏ç‡πà xxs, xs, sm, md, lg, xl, xxl, 3xl, 4xl, 5xl, full
                                  "position": "relative"
                                }
                              ],
                              "position": "absolute",
                              "offsetTop": "xxl",
                              "paddingTop": "xxl",
                              "alignItems": "center",
                              "width": "300px"
                            },
                            {
                              "type": "box",
                              "layout": "vertical",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": column_C,
                                  "color": "#45919d",
                                  "align": "center",
                                  "size": "xl",
                                  "weight": "bold"
                                }
                              ],
                              "position": "relative"
                            }
                          ]
                        },
                        "body": {
                          "type": "box",
                          "layout": "vertical",
                          "contents": [
                            {
                              "type": "text",
                              "text": column_E,
                              "align": "center",
                              "weight": "bold",
                              "color": "#be8c57"
                            },
                            {
                              "type": "text",
                              "text": "-----------------------------",
                              "align": "center",
                              "color": "#c3c1bf"
                            },
                            {
                              "type": "box",
                              "layout": "horizontal",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": ""+column_L,
                                  "align": "center",
                                  "size": "xl",
                                  "weight": "bold",
                                  "color": "#45919d"
                                },
                                {
                                  "type": "text",
                                  "text": ""+column_G,
                                  "align": "center",
                                  "size": "xl",
                                  "weight": "bold",
                                  "color": "#45919d"
                                },
                                {
                                  "type": "text",
                                  "text": column_B,
                                  "align": "center",
                                  "size": "xl",
                                  "weight": "bold",
                                  "color": "#45919d"
                                }
                              ]
                            },
                            {
                              "type": "box",
                              "layout": "horizontal",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "Age",
                                  "align": "center",
                                  "size": "sm",
                                  "color": "#45919d"
                                },
                                {
                                  "type": "text",
                                  "text": "Period of emp.",
                                  "align": "center",
                                  "size": "sm",
                                  "color": "#45919d",
                                  "adjustMode": "shrink-to-fit"
                                },
                                {
                                  "type": "text",
                                  "text": "Code",
                                  "align": "center",
                                  "size": "sm",
                                  "color": "#45919d"
                                }
                              ]
                            },
                            {
                              "type": "box",
                              "layout": "vertical",
                              "contents": [
                                
                              // ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
                                {
                                  "type": "box",
                                  "layout": "horizontal",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#FFFFFF"
                                    },
                                    {
                                      "type": "text",
                                      "text": column_D,
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#e9bf85"
                                    }
                                  ],
                                  "margin": "md",
                                  "borderWidth": "light",
                                  "cornerRadius": "xl",
                                  "backgroundColor": "#404143",
                                  "height": "36px"
                                },
                              // ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà

                              // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô
                                {
                                  "type": "box",
                                  "layout": "horizontal",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#FFFFFF",
                                      "adjustMode": "shrink-to-fit"
                                    },
                                    {
                                      "type": "text",
                                      "text": ""+formattedDate,
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#e9bf85"
                                    }
                                  ],
                                  "margin": "md",
                                  "borderWidth": "light",
                                  "cornerRadius": "xl",
                                  "backgroundColor": "#404143",
                                  "height": "36px"
                                },
                              // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô
                              
                              // ‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 
                                {
                                  "type": "box",
                                  "layout": "horizontal",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#FFFFFF",
                                      "adjustMode": "shrink-to-fit"
                                    },
                                    {
                                      "type": "text",
                                      "text": ""+column_H+" ‡∏ß‡∏±‡∏ô",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#a5eeee"
                                    }
                                  ],
                                  "margin": "md",
                                  "borderWidth": "light",
                                  "cornerRadius": "xl",
                                  "backgroundColor": "#404143",
                                  "height": "36px"
                                },
                              // ‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 

                              // ‡∏•‡∏≤‡∏Å‡∏¥‡∏à-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
                                {
                                  "type": "box",
                                  "layout": "horizontal",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "‡∏•‡∏≤‡∏Å‡∏¥‡∏à-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#FFFFFF",
                                      "adjustMode": "shrink-to-fit"
                                    },
                                    {
                                      "type": "text",
                                      "text": ""+column_I+" ‡∏ß‡∏±‡∏ô",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#a5eeee"
                                    }
                                  ],
                                  "margin": "md",
                                  "borderWidth": "light",
                                  "cornerRadius": "xl",
                                  "backgroundColor": "#404143",
                                  "height": "36px"
                                },
                              // ‡∏•‡∏≤‡∏Å‡∏¥‡∏à-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠

                              // ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 
                                {
                                  "type": "box",
                                  "layout": "horizontal",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#FFFFFF",
                                      "adjustMode": "shrink-to-fit"
                                    },
                                    {
                                      "type": "text",
                                      "text": ""+column_J+" ‡∏ß‡∏±‡∏ô",
                                      "gravity": "center",
                                      "offsetStart": "md",
                                      "color": "#a5eeee"
                                    }
                                  ],
                                  "margin": "md",
                                  "borderWidth": "light",
                                  "cornerRadius": "xl",
                                  "backgroundColor": "#404143",
                                  "height": "36px"
                                },
                              // ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢-‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 

                              ]
                            },
                            {
                              "type": "separator",
                              "margin": "lg"
                            },
                            {
                              "type": "box",
                              "layout": "vertical",
                              "contents": [
                                {
                                  "type": "text",
                                  "text": "Designed by Sine",
                                  "align": "center",
                                  "margin": "md",
                                  "adjustMode": "shrink-to-fit",
                                  "color": "#c3c3c3"
                                }
                              ]
                            }
                          ]
                        }
                      }
                    /* ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± üåí ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î Flex-simulator (üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†ÅøSTOP)  üåí ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± */ 
          }; 
    };


    if (result == '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤') { // ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô #A1
      UrlFetchApp.fetch(line_endpoint, {
        'headers': {
          'Content-Type': 'application/json; charset=UTF-8',
          'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
        },
        'method': 'post',
        'payload': JSON.stringify({
          'replyToken': reply_token,
          'messages': [{
            'type': 'text',
            'text': result
          }],
        }),
      });
    }
    else {
      UrlFetchApp.fetch(line_endpoint, {
        'headers': {
          'Content-Type': 'application/json; charset=UTF-8',
          'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
        },
        'method': 'post',
        'payload': JSON.stringify({
          'replyToken': reply_token,
          'messages': [{
            'type': 'flex',
            'altText': 'HR Report',
            'contents': result
          }],
        }),
      });
    }
    return ContentService.createTextOutput(JSON.stringify({ 'content': 'post ok' })).setMimeType(ContentService.MimeType.JSON); 
          // ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Output ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô JSON
  }
// ‡∏à‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô doPost 

